processStream(0, out( if(acc==0) 
                        then ( [elem(R,0)] ++ [0]) 
                        else ( [elem(R,0)] ++ [elem(elem(streams, acc-1),0)]) 
                        ),acc+1,0,EOF,1);
elem(xs,index) = xs !! index;